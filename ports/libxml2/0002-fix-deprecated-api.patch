diff --git a/catalog.c b/catalog.c
index b47f945..a5655f0 100644
--- a/catalog.c
+++ b/catalog.c
@@ -77,6 +77,9 @@
 #endif
 
 #if defined(_WIN32) && defined(_MSC_VER)
+#if defined(WINAPI_FAMILY) && WINAPI_FAMILY != WINAPI_FAMILY_DESKTOP_APP
+# define getenv(x) NULL
+#endif
 #undef XML_XML_DEFAULT_CATALOG
 static char XML_XML_DEFAULT_CATALOG[256] = "file:///etc/xml/catalog";
 #if defined(_WIN32_WCE)
diff --git a/include/libxml/xmlversion.h b/include/libxml/xmlversion.h
index 59ba74f..fe56b17 100644
--- a/include/libxml/xmlversion.h
+++ b/include/libxml/xmlversion.h
@@ -174,7 +174,7 @@ XMLPUBFUN void XMLCALL xmlCheckVersion(int version);
  *
  * Whether the FTP support is configured in
  */
-#if 1
+#if 0
 #define LIBXML_FTP_ENABLED
 #endif
 
@@ -183,7 +183,7 @@ XMLPUBFUN void XMLCALL xmlCheckVersion(int version);
  *
  * Whether the HTTP support is configured in
  */
-#if 1
+#if 0
 #define LIBXML_HTTP_ENABLED
 #endif
 
diff --git a/nanoftp.c b/nanoftp.c
index 2135ab9..2b2225d 100644
--- a/nanoftp.c
+++ b/nanoftp.c
@@ -108,6 +108,10 @@
 #endif
 #endif
 
+#if defined(WINAPI_FAMILY) && WINAPI_FAMILY != WINAPI_FAMILY_DESKTOP_APP
+# define getenv(x) NULL
+#endif
+
 #ifndef XML_SOCKLEN_T
 #define XML_SOCKLEN_T unsigned int
 #endif
diff --git a/nanohttp.c b/nanohttp.c
index e109ad7..2782b3d 100644
--- a/nanohttp.c
+++ b/nanohttp.c
@@ -113,6 +113,10 @@
 #define XML_SOCKLEN_T unsigned int
 #endif
 
+#if defined(WINAPI_FAMILY) && WINAPI_FAMILY != WINAPI_FAMILY_DESKTOP_APP
+# define getenv(x) NULL
+#endif
+
 #ifdef STANDALONE
 #define DEBUG_HTTP
 #define xmlStrncasecmp(a, b, n) strncasecmp((char *)a, (char *)b, n)
diff --git a/xmlIO.c b/xmlIO.c
index 8a4ebbd..944ca2b 100644
--- a/xmlIO.c
+++ b/xmlIO.c
@@ -3845,10 +3845,12 @@ xmlParserGetDirectory(const char *filename) {
 	else *cur = 0;
 	ret = xmlMemStrdup(dir);
     } else {
+#if defined(WINAPI_FAMILY) && WINAPI_FAMILY == WINAPI_FAMILY_DESKTOP_APP
         if (getcwd(dir, 1024) != NULL) {
 	    dir[1023] = 0;
 	    ret = xmlMemStrdup(dir);
 	}
+#endif
     }
     return(ret);
 #undef IS_XMLPGD_SEP
diff --git a/xmlmemory.c b/xmlmemory.c
index f08c8c3..8b9c35e 100644
--- a/xmlmemory.c
+++ b/xmlmemory.c
@@ -56,6 +56,10 @@ static xmlMutexPtr xmlMemMutex = NULL;
 
 void xmlMallocBreakpoint(void);
 
+#if defined(WINAPI_FAMILY) && WINAPI_FAMILY != WINAPI_FAMILY_DESKTOP_APP
+# define getenv(x) NULL
+#endif
+
 /************************************************************************
  *									*
  *		Macros, variables and associated types			*
-- 
2.10.2.windows.1

