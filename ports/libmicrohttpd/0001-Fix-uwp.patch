diff --git a/src/microhttpd/mhd_sockets.c b/src/microhttpd/mhd_sockets.c
index 47c2d9d..44fbf0d 100644
--- a/src/microhttpd/mhd_sockets.c
+++ b/src/microhttpd/mhd_sockets.c
@@ -451,6 +451,8 @@ MHD_socket_noninheritable_ (MHD_socket sock)
                     F_SETFD,
                     flags | FD_CLOEXEC)) )
     return 0;
+#elif defined(WINAPI_FAMILY) && (WINAPI_FAMILY != WINAPI_FAMILY_DESKTOP_APP)
+    return 0;
 #elif defined(MHD_WINSOCK_SOCKETS)
   if (! SetHandleInformation ((HANDLE)sock,
                               HANDLE_FLAG_INHERIT,
